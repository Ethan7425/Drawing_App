:root{
  /* Pink airy theme */
  --pink-1:#ff7ac6;
  --pink-2:#ff4fb6;
  --pink-3:#ff99d6;
  --ink:#1a0b16;
  --ui-glass:rgba(255,255,255,.18);
  --ui-border:rgba(255,255,255,.25);
  --shadow:0 10px 30px rgba(255,80,180,.25);
  --radius:16px;
  --gap:.7rem;

  /* Video sizing; we switch to contain on tall/portrait phones below */
  --video-fit: cover;
}

html,body{
  margin:0; height:100%;
  font-family: ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  background: radial-gradient(1200px 800px at 50% 20%, #ffd3f0 0%, #ffe6f7 30%, #fff 60%) fixed;
  color:var(--ink);
}

.app{
  position:fixed; inset:0; overflow:hidden;
  touch-action:none; /* our gesture layer */
}

/* Camera background */
video#camera{
  position:absolute; inset:0; width:100%; height:100%;
  object-fit: var(--video-fit);
  background:#000; /* letter/pillar-box color when contained */
  filter: saturate(1.05) contrast(1.02);
}

/* Semi-subtle vignette so the UI pops while tracing */
.app::after{
  content:"";
  position:absolute; inset:0;
  pointer-events:none;
  background:
    radial-gradient(120% 85% at 50% 50%, rgba(0,0,0,0) 60%, rgba(0,0,0,.18) 100%);
}

/* Overlay image the user uploaded */
img#overlay{
  position:absolute; top:50%; left:50%;
  transform-origin:center center; /* transform set via JS */
  max-width:none; max-height:none;
  pointer-events:none;
  opacity:.5; /* JS syncs with slider */
  will-change: transform, opacity;
}

/* Status pill */
.status{
  position:absolute; top:calc(env(safe-area-inset-top,0) + .6rem); left:50%;
  transform:translateX(-50%);
  color:#fff;
  background:linear-gradient(180deg, rgba(255,105,180,.9), rgba(255,60,160,.9));
  border:1px solid rgba(255,255,255,.35);
  padding:.35rem .75rem;
  border-radius:999px;
  font-size:.85rem; font-weight:600;
  z-index:10;
  box-shadow: var(--shadow);
}

/* UI tray */
.ui{
  position:absolute; left:50%; bottom:0; transform:translateX(-50%);
  width:100%; max-width:920px;
  padding: calc(env(safe-area-inset-bottom,0) + .9rem) .9rem .9rem;
  display:flex; flex-direction:column; gap:var(--gap); align-items:center;
  z-index:10;

  /* glassy card */
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  background: linear-gradient(180deg, transparent, rgba(255,255,255,.06) 25%, rgba(255,255,255,.10));
  border-top: 1px solid var(--ui-border);
}

/* Allow normal taps inside controls (so file picker works) */
.ui, .ui *{ touch-action:auto; pointer-events:auto; }

.row{
  width:100%;
  display:flex; flex-wrap:wrap; gap:var(--gap);
  align-items:center; justify-content:center;
}

/* Aerial pink buttons */
button, .btn{
  appearance:none; -webkit-appearance:none;
  border:1px solid var(--ui-border);
  background:
    radial-gradient(120% 120% at 30% 15%, rgba(255,255,255,.85) 0%, rgba(255,255,255,.55) 45%, rgba(255,255,255,.35) 60%, rgba(255,255,255,.25) 100%),
    linear-gradient(180deg, var(--pink-3), var(--pink-2));
  color:#2a0f22;
  border-radius: var(--radius);
  padding:.9rem 1.1rem;
  font-weight:800; letter-spacing:.2px;
  font-size:1rem;
  box-shadow: 0 2px 0 rgba(255,255,255,.6) inset, var(--shadow);
  transition: transform .06s ease, filter .2s ease, box-shadow .2s ease;
}
button:active, .btn:active{ transform: translateY(1px) scale(.99); }
button:focus-visible, .btn:focus-visible{ outline: 2px solid #fff; outline-offset: 2px; }

/* Hidden file input inside a label button (reliable on mobile) */
input[type="file"]{ display:none; }

/* Range slider â€“ pink and chunky */
input[type="range"]{
  -webkit-appearance:none; appearance:none;
  width:min(78vw, 360px); height: 24px; background: transparent;
}
input[type="range"]::-webkit-slider-runnable-track{
  height:10px; border-radius:999px;
  background: linear-gradient(90deg, var(--pink-1), var(--pink-2));
  box-shadow: inset 0 0 0 1px rgba(255,255,255,.45), 0 2px 10px rgba(255,80,180,.25);
}
input[type="range"]::-moz-range-track{
  height:10px; border-radius:999px;
  background: linear-gradient(90deg, var(--pink-1), var(--pink-2));
}
input[type="range"]::-webkit-slider-thumb{
  -webkit-appearance:none; appearance:none;
  width:26px; height:26px; margin-top:-8px; border-radius:50%;
  background: radial-gradient(circle at 30% 25%, #fff 0%, #ffe6f7 50%, #ffd0ef 100%);
  border:1px solid var(--ui-border);
  box-shadow: 0 2px 0 rgba(255,255,255,.8) inset, var(--shadow);
}
input[type="range"]::-moz-range-thumb{
  width:26px; height:26px; border:none; border-radius:50%;
  background: radial-gradient(circle at 30% 25%, #fff 0%, #ffe6f7 50%, #ffd0ef 100%);
  box-shadow: 0 2px 0 rgba(255,255,255,.8) inset, var(--shadow);
}

.label, #opacityVal, .hint{
  color:#3a1731;
  font-size:.95rem; font-weight:700;
  text-shadow: 0 1px 0 rgba(255,255,255,.6);
}
.hint{ text-align:center; width:100%; margin-top:.2rem; opacity:.75; }

/* Camera frame container */
.camera-frame {
  position: relative;
  width: 90%;              /* responsive: 90% of viewport width */
  max-width: 500px;        /* optional max so it doesn't get huge on tablets */
  aspect-ratio: 3/4;       /* keeps camera window shape consistent */
  margin: 1rem auto;       /* center horizontally with spacing */
  border: 4px solid var(--pink-2);
  border-radius: 16px;
  overflow: hidden;
  box-shadow: 0 8px 24px rgba(255, 80, 180, 0.3);
}

/* Camera video stays inside the frame */
.camera-frame video {
  width: 100%;
  height: 100%;
  object-fit: cover;  /* or 'contain' if you want no cropping */
  background: #000;
}

/* Overlay image sits on top of the video */
.camera-frame img#overlay {
  position: absolute;
  top: 50%;
  left: 50%;
  transform-origin: center center;
  max-width: none;
  max-height: none;
  pointer-events: none;
  opacity: .5;
  will-change: transform, opacity;
}


/* --- Sliding options panel --- */

/* Toggle handle */
.ui-toggle{
  position:absolute;
  left:50%;
  bottom: calc(100% - 12px); /* sits just above the panel edge */
  transform: translateX(-50%);
  z-index: 11;
  appearance:none; -webkit-appearance:none;
  border:1px solid var(--ui-border);
  border-radius: 999px;
  padding:.5rem .9rem;
  font-weight:800;
  font-size:.95rem;
  background:
    radial-gradient(120% 120% at 30% 15%, rgba(255,255,255,.9) 0%, rgba(255,255,255,.55) 50%, rgba(255,255,255,.35) 100%),
    linear-gradient(180deg, var(--pink-3), var(--pink-2));
  color:#2a0f22;
  box-shadow: 0 2px 0 rgba(255,255,255,.6) inset, var(--shadow);
  display:flex; align-items:center; gap:.5rem;
}
.ui-toggle .chev{
  display:inline-block; transition: transform .2s ease;
}

/* Panel container (already has glass background on .ui) */
.ui{
  padding-bottom: max(.9rem, calc(env(safe-area-inset-bottom,0) + .9rem));
  z-index: 10;
}

.ui, .ui * { touch-action: auto; pointer-events: auto; }

/* The collapsible part */
.ui-panel{
  width:100%;
  overflow:hidden;
  transition: max-height .25s ease, opacity .2s ease, transform .25s ease;
  max-height: 600px; /* large enough to fit content when open */
  opacity: 1;
  transform: translateY(0);
}

/* Collapsed state controlled by .ui.collapsed */
.ui.collapsed .ui-panel{
  max-height: 0;
  opacity: .0;
  transform: translateY(6px);
}

/* Rotate arrow when collapsed */
.ui.collapsed .ui-toggle .chev{ transform: rotate(180deg); }

/* Ensure UI is interactive (so file input works) */
.ui, .ui *{ touch-action:auto; pointer-events:auto; }

/* Keep the panel centered and comfy on phones */
@media (max-width: 480px){
  .ui-toggle{ font-size:.9rem; padding:.5rem .8rem; }
}



/* Make it really comfy on phones */
@media (max-width: 480px){
  :root{ --radius:14px; }
  button, .btn{ padding:.85rem 1rem; font-size:.98rem; }
  .status{ font-size:.8rem; }
}

/* If the screen is tall/portrait or very narrow, show full camera frame (no crop) */
@media (max-aspect-ratio: 3/4), (max-width: 420px){
  :root{ --video-fit: contain; }
}

/* If landscape/short, keep cover for immersive tracing */
@media (min-aspect-ratio: 4/3){
  :root{ --video-fit: cover; }
}

/* Respect notches & home indicators */
.ui{ padding-left: max(.9rem, env(safe-area-inset-left,0));
     padding-right: max(.9rem, env(safe-area-inset-right,0)); }
